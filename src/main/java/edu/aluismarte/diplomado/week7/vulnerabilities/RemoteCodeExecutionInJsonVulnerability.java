package edu.aluismarte.diplomado.week7.vulnerabilities;

import com.fasterxml.jackson.databind.ObjectMapper;
import edu.aluismarte.diplomado.model.week7.Product;

/**
 * Como puedo hacer ejecuci√≥n de data remota usando un JSON
 *
 * @author aluis on 5/8/2022.
 * @see <a href="https://bbossola.wordpress.com/2018/04/14/remotely-execute-java-code-using-json/">remotely-execute-java-code-using-json</a>
 * @see <a href="https://github.com/bbossola/vulnerability-java-samples">vulnerability-java-samples</a>
 */
public class RemoteCodeExecutionInJsonVulnerability {

    private static final ObjectMapper deserializer = new ObjectMapper().enableDefaultTyping();

    public void simulatePOSTRequest(String json) {
        try {
            System.out.println("Solo leo el JSON y no hago nada");
            deserializer.readValue(json, Product.class);
            System.out.println("Literalmente no deberia pasar nada");
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
}
